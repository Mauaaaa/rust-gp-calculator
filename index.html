<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rust Labs: Command Center v1.6</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
<style>
/* --- CORE VARIABLES --- */
:root {
    --bg-dark: #101010;
    --bg-sidebar: #080808;
    --bg-panel: #1a1a1a;
    --border: #333;
    
    /* Theme Colors */
    --c-raid: #ff4757;   /* Combat Red */
    --c-build: #5352ed;  /* Blueprint Blue */
    --c-farm: #2ed573;   /* Nature Green */
    --c-ind: #ffa502;    /* Hazmat Orange */
    --c-text: #e0e0e0;
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
    font-family: 'Inter', sans-serif;
    background: var(--bg-dark);
    color: var(--c-text);
    display: flex;
    height: 100vh;
    overflow: hidden;
}

/* --- SIDEBAR --- */
.sidebar {
    width: 260px;
    background: var(--bg-sidebar);
    border-right: 1px solid var(--border);
    display: flex; flex-direction: column;
    padding: 20px; flex-shrink: 0; overflow-y: auto;
}

.brand {
    font-family: 'Oswald', sans-serif; font-size: 22px; color: #fff;
    text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px;
    display: flex; align-items: center; gap: 12px;
}
.brand span { color: var(--c-raid); }
.version { 
    font-size: 10px; color: #666; margin-bottom: 25px; 
    text-transform: uppercase; letter-spacing: 1px; padding-left: 48px; 
}

/* LOGO SVG STYLING */
.logo-svg { width: 36px; height: 36px; fill: none; stroke: var(--c-raid); stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }

.nav-header {
    font-size: 11px; font-weight: 800; text-transform: uppercase;
    color: #666; margin: 20px 0 10px 0; letter-spacing: 1px;
}

.nav-item {
    padding: 12px; margin-bottom: 4px; border-radius: 6px;
    cursor: pointer; font-size: 13px; font-weight: 600; color: #888;
    display: flex; align-items: center; gap: 10px; transition: 0.2s;
}
.nav-item:hover { background: #111; color: #fff; }
.nav-item.active { background: #222; color: #fff; border-left: 3px solid #fff; }

/* Active Theme Colors */
.nav-item.active[data-theme="raid"] { border-color: var(--c-raid); color: var(--c-raid); background: rgba(255, 71, 87, 0.1); }
.nav-item.active[data-theme="build"] { border-color: var(--c-build); color: var(--c-build); background: rgba(83, 82, 237, 0.1); }
.nav-item.active[data-theme="farm"] { border-color: var(--c-farm); color: var(--c-farm); background: rgba(46, 213, 115, 0.1); }
.nav-item.active[data-theme="ind"] { border-color: var(--c-ind); color: var(--c-ind); background: rgba(255, 165, 2, 0.1); }

/* --- MAIN CONTENT --- */
.main {
    flex: 1; padding: 40px; overflow-y: auto;
    background-image: radial-gradient(circle at top right, #1a1a1a 0%, #0f0f0f 60%);
}

.view { display: none; max-width: 1000px; margin: 0 auto; animation: fadeUp 0.3s ease; }
.view.active { display: block; }
@keyframes fadeUp { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }

header { margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 15px; }
h2 { font-family: 'Oswald'; font-size: 32px; text-transform: uppercase; margin-bottom: 5px; }
.subtitle { color: #888; font-size: 14px; }

/* --- CARDS & GRIDS --- */
.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
.card {
    background: var(--bg-panel); border: 1px solid var(--border);
    border-radius: 12px; padding: 25px; position: relative; overflow: hidden;
}

/* Theme Accents for Cards */
.view[data-theme="raid"] .card { border-top: 4px solid var(--c-raid); }
.view[data-theme="build"] .card { border-top: 4px solid var(--c-build); }
.view[data-theme="farm"] .card { border-top: 4px solid var(--c-farm); }
.view[data-theme="ind"] .card { border-top: 4px solid var(--c-ind); }

.card h3 { 
    font-family: 'Oswald'; font-size: 18px; text-transform: uppercase; 
    margin-bottom: 20px; color: #fff; display: flex; justify-content: space-between;
}

/* --- FORMS --- */
label { display: block; font-size: 11px; font-weight: 700; text-transform: uppercase; color: #666; margin: 15px 0 5px; }
input, select {
    width: 100%; background: #0a0a0a; border: 1px solid #333; color: #fff;
    padding: 12px; border-radius: 6px; font-family: 'Inter'; font-size: 14px; outline: none;
}
input:focus, select:focus { border-color: #666; }

button {
    width: 100%; margin-top: 20px; padding: 14px; border-radius: 8px; border: none;
    font-weight: 800; text-transform: uppercase; cursor: pointer; font-size: 14px; color: #fff;
    transition: transform 0.1s;
}
button:hover { opacity: 0.9; }
button:active { transform: scale(0.98); }

/* Theme Buttons */
.btn-raid { background: var(--c-raid); box-shadow: 0 4px 15px rgba(255, 71, 87, 0.2); }
.btn-build { background: var(--c-build); box-shadow: 0 4px 15px rgba(83, 82, 237, 0.2); }
.btn-farm { background: var(--c-farm); box-shadow: 0 4px 15px rgba(46, 213, 115, 0.2); }
.btn-ind { background: var(--c-ind); box-shadow: 0 4px 15px rgba(255, 165, 2, 0.2); }

/* --- RESULTS & EXTRAS --- */
.result-box { 
    margin-top: 20px; background: rgba(0,0,0,0.2); border-radius: 8px; 
    padding: 15px; border: 1px dashed #444; 
}
.row { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 14px; color: #ccc; }
.row strong { color: #fff; }

/* Comparison Table */
.comp-table { width: 100%; border-collapse: collapse; font-size: 14px; color: #ccc; }
.comp-table th { text-align: left; padding-bottom: 10px; color: #666; font-size: 12px; text-transform: uppercase; }
.comp-table td { padding: 8px 0; border-bottom: 1px solid #222; }
.diff-good { color: var(--c-farm); font-weight: bold; }
.diff-bad { color: var(--c-raid); font-weight: bold; }

/* Eco Recommendation Banner */
.eco-rec {
    background: rgba(255, 255, 255, 0.05); border-left: 3px solid #fff;
    padding: 10px; margin-bottom: 15px; font-size: 13px; color: #ccc;
    display: flex; align-items: center; gap: 10px;
}
.eco-rec i { font-style: normal; font-size: 16px; }

/* Base Design Cards */
.base-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
.base-card { background: #111; border: 1px solid #333; border-radius: 8px; overflow: hidden; }
.base-video { height: 160px; background: #000; display: flex; align-items: center; justify-content: center; position: relative; }
.base-video::after { content: '‚ñ∂'; font-size: 40px; color: rgba(255,255,255,0.5); }
.base-info { padding: 20px; }
.base-title { font-family: 'Oswald'; font-size: 20px; color: #fff; margin-bottom: 5px; }
.base-stats { display: flex; gap: 10px; margin-bottom: 15px; font-size: 11px; color: #888; }
.stat-box { background: #222; padding: 4px 8px; border-radius: 4px; border: 1px solid #333; }
.pros-cons { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 12px; }
.pro-list { color: var(--c-farm); list-style: none; padding: 0; }
.con-list { color: var(--c-raid); list-style: none; padding: 0; }
.pro-list li::before { content:'+ '; font-weight:bold; }
.con-list li::before { content:'- '; font-weight:bold; }

/* Gene Grid */
.gene-row { display: flex; gap: 5px; margin-bottom: 10px; justify-content: center; }
.gene-input { 
    width: 40px; height: 40px; text-align: center; font-weight: 800; font-size: 18px; 
    text-transform: uppercase; background: #111; border: 1px solid #444; color: #fff; border-radius: 4px;
}

/* Toggle Switch */
.toggle-row { display: flex; gap: 10px; align-items: center; margin-bottom: 15px; }
.toggle-btn {
    flex: 1; padding: 8px; background: #222; border: 1px solid #444; color: #888;
    text-align: center; cursor: pointer; font-size: 12px; font-weight: bold; border-radius: 4px;
}
.toggle-btn.active { background: #e74c3c; color: #fff; border-color: #ff6b6b; }

/* --- PATCH NOTES MODAL --- */
.modal-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
    z-index: 999; display: flex; justify-content: center; align-items: center;
    opacity: 0; pointer-events: none; transition: 0.3s;
}
.modal-overlay.open { opacity: 1; pointer-events: all; }

.patch-modal {
    background: #111; width: 600px; max-width: 90%; max-height: 80vh;
    border: 1px solid #333; border-radius: 12px; display: flex; flex-direction: column;
    box-shadow: 0 20px 50px rgba(0,0,0,0.8);
}

.patch-header {
    padding: 25px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center;
    background: radial-gradient(circle at top right, #1a1a1a, #111);
}
.patch-title h3 { font-family: 'Oswald'; font-size: 24px; color: #fff; margin: 0; text-transform: uppercase; }
.patch-title span { color: var(--c-raid); font-size: 12px; letter-spacing: 2px; }

.patch-body { padding: 25px; overflow-y: auto; }
.update-block { margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px dashed #333; }
.update-ver { font-size: 14px; font-weight: 800; color: #fff; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
.tag-new { background: var(--c-raid); color: #fff; font-size: 9px; padding: 2px 6px; border-radius: 4px; }
.update-list { list-style: none; padding: 0; margin: 0; font-size: 13px; color: #aaa; line-height: 1.6; }
.update-list li { margin-bottom: 5px; position: relative; padding-left: 15px; }
.update-list li::before { content: '‚Ä¢'; color: var(--c-ind); position: absolute; left: 0; }

.patch-footer { padding: 20px; border-top: 1px solid #222; text-align: right; }
.btn-close {
    background: #fff; color: #000; padding: 12px 30px; font-weight: 800;
    text-transform: uppercase; border-radius: 6px; border: none; cursor: pointer;
    transition: 0.2s; font-size: 14px;
}
.btn-close:hover { transform: scale(1.02); box-shadow: 0 0 15px rgba(255,255,255,0.2); }

/* Mobile */
@media (max-width: 768px) {
    body { flex-direction: column; height: auto; overflow: visible; }
    .sidebar { width: 100%; overflow-x: auto; flex-direction: row; border-right: none; border-bottom: 1px solid #333; }
    .nav-header, .brand { display: none; }
    .nav-item { white-space: nowrap; margin: 0; padding: 10px; }
    .grid-2 { grid-template-columns: 1fr; }
    .main { padding: 20px; }
}
</style>
</head>
<body>

<div id="patchModal" class="modal-overlay open">
    <div class="patch-modal">
        <div class="patch-header">
            <div class="brand">
                <svg class="logo-svg" viewBox="0 0 24 24"><path d="M12 2L2 7l10 5 10-5-10-5zm0 9l2-10 2 10m-4 0l-2-10-2 10m4 0v10l-10-5 10-5zm0 0v10l10-5-10-5z"></path></svg>
                <div class="patch-title">
                    <h3>Command Center</h3>
                    <span>Update Log</span>
                </div>
            </div>
        </div>
        <div class="patch-body">
            <div class="update-block">
                <div class="update-ver">v1.6 <span class="tag-new">LATEST</span></div>
                <ul class="update-list">
                    <li>Added Patch Notes System (Startup Popup).</li>
                    <li>Designed Custom Vector Logo.</li>
                    <li>Implemented Version History tracking.</li>
                    <li>Added "Smelting Calculator" to Industry Tab.</li>
                    <li>Added "Base Design Library" with 2026 Meta builds.</li>
                </ul>
            </div>
            <div class="update-block">
                <div class="update-ver" style="opacity:0.7">v1.5</div>
                <ul class="update-list">
                    <li>Fixed Raid Math: Now uses Hardcoded Lookup Tables for 100% accuracy.</li>
                    <li>Added "Explosive Raids" tab separate from Crafting.</li>
                    <li>Added High External Walls to Raid targets.</li>
                </ul>
            </div>
            <div class="update-block">
                <div class="update-ver" style="opacity:0.7">v1.4</div>
                <ul class="update-list">
                    <li>Code Cleanup: Removed non-math sections.</li>
                    <li>Fixed Eco Raid: Spears now do 0 dmg to Metal/Armored.</li>
                    <li>Added "Fresh vs Refill" toggle for Eco Raiding.</li>
                </ul>
            </div>
            <div class="update-block">
                <div class="update-ver" style="opacity:0.7">v1.3</div>
                <ul class="update-list">
                    <li>Overhauled Visual Footprint Guide (CSS Grid).</li>
                    <li>Added Smart Recycler "Keep vs Scrap" logic.</li>
                </ul>
            </div>
        </div>
        <div class="patch-footer">
            <button class="btn-close" onclick="closeModal()">Close</button>
        </div>
    </div>
</div>

<nav class="sidebar">
    <div class="brand">
        <svg class="logo-svg" viewBox="0 0 100 100">
            <path d="M50 5 L93.3 30 V80 L50 105 L6.7 80 V30 Z" fill="none" stroke="#ff4757" stroke-width="4"/>
            <circle cx="50" cy="55" r="15" fill="none" stroke="#e0e0e0" stroke-width="3"/>
            <line x1="50" y1="20" x2="50" y2="40" stroke="#e0e0e0" stroke-width="3"/>
            <line x1="50" y1="70" x2="50" y2="90" stroke="#e0e0e0" stroke-width="3"/>
            <line x1="15" y1="55" x2="35" y2="55" stroke="#e0e0e0" stroke-width="3"/>
            <line x1="65" y1="55" x2="85" y2="55" stroke="#e0e0e0" stroke-width="3"/>
        </svg>
        RUST<span>LABS</span>
    </div>
    <div class="version">Version 1.6</div>

    <div class="nav-header">Combat</div>
    <div class="nav-item active" data-theme="raid" onclick="setView('craft')">üí£ Crafting Calc</div>
    <div class="nav-item" data-theme="raid" onclick="setView('raid')">üí• Explosive Raids</div>
    <div class="nav-item" data-theme="raid" onclick="setView('eco')">üî® Eco Raiding</div>
    <div class="nav-item" data-theme="raid" onclick="setView('compare')">‚öñÔ∏è Full Compare</div>

    <div class="nav-header">Construction</div>
    <div class="nav-item" data-theme="build" onclick="setView('library')">üè∞ Base Library</div>

    <div class="nav-header">Nature</div>
    <div class="nav-item" data-theme="farm" onclick="setView('gene')">üß¨ Gene Lab</div>
    <div class="nav-item" data-theme="farm" onclick="setView('nodes')">‚õè Sulfur Nodes</div>

    <div class="nav-header">Industry</div>
    <div class="nav-item" data-theme="ind" onclick="setView('smelt')">üî• Smelting</div>
    <div class="nav-item" data-theme="ind" onclick="setView('recycle')">‚ôª Smart Recycler</div>
    <div class="nav-item" data-theme="ind" onclick="setView('diesel')">‚õΩ Diesel/Fuel</div>
    <div class="nav-item" data-theme="ind" onclick="setView('flight')">üöÅ Flight Logistics</div>
    <div class="nav-item" data-theme="ind" onclick="setView('scrapgp')">üî© Scrap to GP</div>
    
    <div style="margin-top:auto; padding-top:20px; border-top:1px solid #222;">
        <div class="nav-item" onclick="openModal()" style="font-size:11px; opacity:0.6;">üìú View Patch Notes</div>
    </div>
</nav>

<main class="main">

    <div id="view-craft" class="view active" data-theme="raid">
        <header><h2 style="color:var(--c-raid)">Crafting Calculator</h2><p class="subtitle">Calculate raw resources for crafting batches.</p></header>
        <div class="card">
            <h3>üè≠ Production Cost</h3>
            <div class="grid-2">
                <div>
                    <label>Item to Craft</label>
                    <select id="craftItem">
                        <option value="rocket">Rocket</option>
                        <option value="c4">C4</option>
                        <option value="satchel">Satchel Charge</option>
                        <option value="beancan">Beancan Grenade</option>
                        <option value="ammo">Explosive Ammo</option>
                    </select>
                </div>
                <div>
                    <label>Quantity to Craft</label>
                    <input type="number" id="craftQty" value="1">
                </div>
            </div>
            <label>Gunpowder Method</label>
            <select id="craftMethod">
                <option value="mix">Mixing Table (Cheaper Charcoal)</option>
                <option value="inv">Hand Crafted (Expensive)</option>
            </select>
            <button class="btn-raid" onclick="calcCraft()">Calculate Raw Materials</button>
            <div id="craftRes" class="result-box" style="display:none"></div>
        </div>
    </div>

    <div id="view-raid" class="view" data-theme="raid">
        <header><h2 style="color:var(--c-raid)">Explosive Raids</h2><p class="subtitle">Calculate rockets needed to break a target.</p></header>
        <div class="card">
            <h3>üí• Raid Math</h3>
            <div class="grid-2">
                <div>
                    <label>Target</label>
                    <select id="raidTarget">
                        <option value="wall.stone">Stone Wall</option>
                        <option value="wall.metal">Sheet Metal Wall</option>
                        <option value="wall.armored">Armored Wall</option>
                        <option value="wall.ext_stone">High Ext. Stone Wall</option>
                        <option value="wall.ext_wood">High Ext. Wood Wall</option>
                        <option value="door.sheet">Sheet Metal Door</option>
                        <option value="door.garage">Garage Door</option>
                        <option value="door.armored">Armored Door</option>
                        <option value="window.reinforced">Reinforced Window</option>
                    </select>
                </div>
                <div>
                    <label>Ammo Type</label>
                    <select id="raidAmmo">
                        <option value="rocket">Rocket</option>
                        <option value="c4">C4</option>
                        <option value="satchel">Satchel</option>
                        <option value="ammo">Explosive Ammo</option>
                    </select>
                </div>
            </div>
            <label>Number of Targets</label>
            <input type="number" id="raidCount" value="1">
            
            <button class="btn-raid" onclick="calcRaid()">Calculate Boom Needed</button>
            <div id="raidRes" class="result-box" style="display:none"></div>
        </div>
    </div>

    <div id="view-eco" class="view" data-theme="raid">
        <header><h2 style="color:var(--c-raid)">Eco Raiding</h2><p class="subtitle">Soft-Side & Tool Calculation</p></header>
        <div class="card">
            <h3>üî® Durability Math</h3>
            
            <label>Target Structure</label>
            <select id="ecoTarget" onchange="updateEcoRec()">
                <option value="wall.wood">Wood Wall (Soft Side)</option>
                <option value="wall.stone">Stone Wall (Soft Side)</option>
                <option value="wall.metal">Metal Wall (Soft Side)</option>
                <option value="door.wood">Wood Door</option>
                <option value="door.sheet">Sheet Metal Door</option>
            </select>

            <div id="ecoRec" class="eco-rec"><i>üí°</i> <span>Select a target.</span></div>

            <div class="toggle-row">
                <div class="toggle-btn active" id="modeFresh" onclick="setEcoMode('fresh')">Fresh Tools (Crafting)</div>
                <div class="toggle-btn" id="modeRefill" onclick="setEcoMode('refill')">Refills (Repair Bench)</div>
            </div>

            <div class="grid-2">
                <div>
                    <label>Tool</label>
                    <select id="ecoTool">
                        <option value="spear">Wooden Spear</option>
                        <option value="jack">Jackhammer</option>
                        <option value="pick">Metal Pickaxe</option>
                        <option value="sword">Salvaged Sword</option>
                        <option value="hatchet">Hatchet</option>
                    </select>
                </div>
                <div><label>Wall Count</label><input type="number" id="ecoCount" value="1"></div>
            </div>

            <button class="btn-raid" onclick="calcEco()">Calculate</button>
            <div id="ecoRes" class="result-box" style="display:none"></div>
        </div>
    </div>

    <div id="view-compare" class="view" data-theme="raid">
        <header><h2 style="color:var(--c-raid)">Resource Comparison</h2></header>
        <div class="grid-2">
            <div class="card">
                <h3>Option A</h3>
                <select id="compA"><option value="rocket">Rocket</option><option value="c4">C4</option><option value="satchel">Satchel</option></select>
                <input type="number" id="amtA" value="4" style="margin-top:10px">
            </div>
            <div class="card">
                <h3>Option B</h3>
                <select id="compB"><option value="c4">C4</option><option value="rocket">Rocket</option><option value="satchel">Satchel</option></select>
                <input type="number" id="amtB" value="2" style="margin-top:10px">
            </div>
        </div>
        <button class="btn-raid" onclick="calcCompare()">Full Breakdown</button>
        <div id="compRes" class="result-box" style="display:none"></div>
    </div>

    <div id="view-library" class="view" data-theme="build">
        <header><h2 style="color:var(--c-build)">Base Library</h2><p class="subtitle">Standard Meta Builds (2026)</p></header>
        <div class="base-grid">
            
            <div class="base-card">
                <div class="base-video">Youtube Video</div>
                <div class="base-info">
                    <div class="base-title">The Standard 2x1</div>
                    <div class="base-stats">
                        <span class="stat-box">Build: ~3k Stone</span>
                        <span class="stat-box">Upkeep: ~500 Stone</span>
                    </div>
                    <div class="pros-cons">
                        <ul class="pro-list"><li>Cheap</li><li>Fast to build</li><li>Easy to hide</li></ul>
                        <ul class="con-list"><li>Weak Defense</li><li>Low Storage</li></ul>
                    </div>
                </div>
            </div>

            <div class="base-card">
                <div class="base-video">Youtube Video</div>
                <div class="base-info">
                    <div class="base-title">Honeycombed 2x2</div>
                    <div class="base-stats">
                        <span class="stat-box">Build: ~12k Stone</span>
                        <span class="stat-box">Upkeep: ~2k Stone</span>
                    </div>
                    <div class="pros-cons">
                        <ul class="pro-list"><li>Good Space</li><li>12-16 Rocket Raid</li><li>Roof Access</li></ul>
                        <ul class="con-list"><li>Generic</li><li>Target for clans</li></ul>
                    </div>
                </div>
            </div>

            <div class="base-card">
                <div class="base-video">Youtube Video</div>
                <div class="base-info">
                    <div class="base-title">The Mini-Fort Bunker</div>
                    <div class="base-stats">
                        <span class="stat-box">Build: ~15k Stone</span>
                        <span class="stat-box">Upkeep: ~3k Stone</span>
                    </div>
                    <div class="pros-cons">
                        <ul class="pro-list"><li>24+ Rocket Raid</li><li>Pixel Gaps</li><li>Offline Protection</li></ul>
                        <ul class="con-list"><li>Complex Build</li><li>High HQM Cost</li></ul>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <div id="view-smelt" class="view" data-theme="ind">
        <header><h2 style="color:var(--c-ind)">Smelting Calculator</h2></header>
        <div class="card">
            <h3>üî• Wood Required</h3>
            <div class="grid-2">
                <div>
                    <label>Sulfur Ore</label><input type="number" id="smeltSulfur" value="0">
                    <label>Metal Ore</label><input type="number" id="smeltMetal" value="0">
                    <label>HQM Ore</label><input type="number" id="smeltHQM" value="0">
                </div>
                <div>
                    <label>Furnace Type</label>
                    <select id="furnaceType">
                        <option value="small">Small Furnace</option>
                        <option value="large">Large Furnace</option>
                    </select>
                </div>
            </div>
            <button class="btn-ind" onclick="calcSmelt()">Calculate Wood</button>
            <div id="smeltRes" class="result-box" style="display:none"></div>
        </div>
    </div>

    <div id="view-gene" class="view" data-theme="farm">
        <header><h2 style="color:var(--c-farm)">Gene Laboratory</h2></header>
        <div class="card">
            <h3>üß¨ Crossbreeder</h3>
            <label>Donor 1</label><div class="gene-row"><input class="gene-input" id="d1_1" maxlength="1"><input class="gene-input" id="d1_2" maxlength="1"><input class="gene-input" id="d1_3" maxlength="1"><input class="gene-input" id="d1_4" maxlength="1"><input class="gene-input" id="d1_5" maxlength="1"><input class="gene-input" id="d1_6" maxlength="1"></div>
            <label>Donor 2</label><div class="gene-row"><input class="gene-input" id="d2_1" maxlength="1"><input class="gene-input" id="d2_2" maxlength="1"><input class="gene-input" id="d2_3" maxlength="1"><input class="gene-input" id="d2_4" maxlength="1"><input class="gene-input" id="d2_5" maxlength="1"><input class="gene-input" id="d2_6" maxlength="1"></div>
            <button class="btn-farm" onclick="calcGene()">Predict Offspring</button>
            <div id="geneRes" class="result-box" style="display:none; text-align:center; font-size:24px; letter-spacing:8px; font-weight:bold;"></div>
        </div>
    </div>

    <div id="view-nodes" class="view" data-theme="farm">
        <header><h2 style="color:var(--c-farm)">Sulfur Nodes</h2></header>
        <div class="card">
            <h3>‚õè Mining Goals</h3>
            <label>Sulfur Needed</label><input type="number" id="nodeNeed" placeholder="e.g. 15000">
            <button class="btn-farm" onclick="calcNodes()">Calculate</button>
            <div id="nodeRes" class="result-box" style="display:none"></div>
        </div>
    </div>

    <div id="view-recycle" class="view" data-theme="ind">
        <header><h2 style="color:var(--c-ind)">Smart Recycler</h2></header>
        <div class="grid-2">
            <div class="card">
                <h3>Inventory</h3>
                <label>Tech Trash</label><input type="number" id="recTech" value="0">
                <label>Rifle Body</label><input type="number" id="recRifle" value="0">
                <label>SMG Body</label><input type="number" id="recSMG" value="0">
                <label>Gears</label><input type="number" id="recGear" value="0">
                <label>Springs</label><input type="number" id="recSpring" value="0">
                <label>Sheet Metal</label><input type="number" id="recSheet" value="0">
            </div>
            <div class="card">
                <h3>Settings</h3>
                <label>Location</label>
                <select id="recZone"><option value="unsafe">Monument (100% Yield)</option><option value="safe">Safe Zone (80% Yield)</option></select>
                <label>Target (Optional)</label>
                <input type="number" id="recTarget" placeholder="I need 500 Scrap...">
                <button class="btn-ind" onclick="calcRecycle()">Analyze Recycle</button>
                <div id="recRes" class="result-box" style="display:none"></div>
            </div>
        </div>
    </div>

    <div id="view-diesel" class="view" data-theme="ind">
        <header><h2 style="color:var(--c-ind)">Heavy Industry</h2></header>
        <div class="card">
            <h3>‚õΩ Fuel Converter</h3>
            <div class="grid-2">
                <div><label>Diesel</label><input type="number" id="dieselAmt" value="1"></div>
                <div><label>Machine</label><select id="dieselLoc"><option value="excavator">Excavator</option><option value="quarry">Quarry</option></select></div>
            </div>
            <label>Output Type</label><select id="dieselType"><option value="sulfur">Sulfur</option><option value="hqm">HQM</option><option value="metal">Metal</option><option value="stone">Stone</option></select>
            <button class="btn-ind" onclick="calcDiesel()">Run Engine</button>
            <div id="dieselRes" class="result-box" style="display:none"></div>
        </div>
    </div>

    <div id="view-flight" class="view" data-theme="ind">
        <header><h2 style="color:var(--c-ind)">Flight Logistics</h2></header>
        <div class="card">
            <h3>üöÅ Fuel Gauge</h3>
            <label>Low Grade Fuel</label><input type="number" id="lgfHeli" value="100">
            <label>Vehicle</label><select id="heliType"><option value="30">Minicopter (30/min)</option><option value="45">Attack Heli (45/min)</option></select>
            <button class="btn-ind" onclick="calcHeli()">Check Fuel</button>
            <div id="heliRes" class="result-box" style="display:none"></div>
        </div>
    </div>

    <div id="view-scrapgp" class="view" data-theme="ind">
        <header><h2 style="color:var(--c-ind)">Scrap Arbitrage</h2></header>
        <div class="card">
            <h3>üî© Scrap to GP</h3>
            <label>Gunpowder Wanted</label><input type="number" id="gpWant" value="1000">
            <button class="btn-ind" onclick="calcScrapGP()">Calculate</button>
            <div id="gpRes" class="result-box" style="display:none"></div>
        </div>
    </div>

</main>

<script>
/* --- GLOBAL STATE --- */
let ecoMode = 'fresh'; // 'fresh' or 'refill'

/* --- UI NAVIGATION --- */
function setView(id) {
    document.querySelectorAll('.view').forEach(e => e.classList.remove('active'));
    document.getElementById('view-'+id).classList.add('active');
    document.querySelectorAll('.nav-item').forEach(e => e.classList.remove('active'));
    document.querySelectorAll(`.nav-item[onclick="setView('${id}')"]`).forEach(e => e.classList.add('active'));
}

function setEcoMode(mode) {
    ecoMode = mode;
    document.getElementById('modeFresh').classList.toggle('active', mode === 'fresh');
    document.getElementById('modeRefill').classList.toggle('active', mode === 'refill');
}

function closeModal() { document.getElementById('patchModal').classList.remove('open'); }
function openModal() { document.getElementById('patchModal').classList.add('open'); }

/* --- 1. CRAFTING CALCULATOR (RESOURCES) --- */
function calcCraft() {
    const type = document.getElementById('craftItem').value;
    const qty = +document.getElementById('craftQty').value;
    const method = document.getElementById('craftMethod').value;

    const getCostPerItem = (t) => {
        if(t==='rocket') return {s:1400, c:1950, f:100, p:2, tech:0, fuel:30};
        if(t==='c4') return {s:2200, c:3000, f:200, p:0, tech:2, fuel:60};
        if(t==='satchel') return {s:480, c:720, f:80, p:0, tech:0, fuel:0};
        if(t==='beancan') return {s:120, c:180, f:20, p:0, tech:0, fuel:0};
        if(t==='ammo') return {s:25, c:30, f:10, p:0, tech:0, fuel:0};
    };

    const base = getCostPerItem(type);
    let s = base.s * qty;
    let c = base.c * qty;
    let f = base.f * qty;

    if(method === 'mix') c = c * 0.7; // Charcoal discount

    document.getElementById('craftRes').style.display = 'block';
    document.getElementById('craftRes').innerHTML = `
        <div class="row"><span>Sulfur</span> <strong style="color:#ff4757">${s.toLocaleString()}</strong></div>
        <div class="row"><span>Charcoal</span> <strong>${Math.floor(c).toLocaleString()}</strong></div>
        <div class="row"><span>Metal Frags</span> <strong>${f.toLocaleString()}</strong></div>
        ${base.p > 0 ? `<div class="row"><span>Pipes</span> <strong>${base.p * qty}</strong></div>` : ''}
        ${base.tech > 0 ? `<div class="row"><span>Tech Trash</span> <strong>${base.tech * qty}</strong></div>` : ''}
        ${base.fuel > 0 ? `<div class="row"><span>Low Grade</span> <strong>${base.fuel * qty}</strong></div>` : ''}
    `;
}

/* --- 2. EXPLOSIVE RAIDS (LOOKUP TABLE FIX) --- */
function calcRaid() {
    const target = document.getElementById('raidTarget').value;
    const ammo = document.getElementById('raidAmmo').value;
    const count = +document.getElementById('raidCount').value;

    // Hardcoded Rust Labs Hits Table (Target -> Ammo -> Count)
    const hitsTable = {
        'wall.stone': { rocket: 2, c4: 1, satchel: 4, ammo: 72 },
        'wall.metal': { rocket: 4, c4: 2, satchel: 9, ammo: 200 },
        'wall.armored': { rocket: 8, c4: 3, satchel: 19, ammo: 400 },
        'wall.ext_stone': { rocket: 4, c4: 2, satchel: 9, ammo: 200 },
        'wall.ext_wood': { rocket: 2, c4: 1, satchel: 4, ammo: 72 },
        'door.sheet': { rocket: 1, c4: 1, satchel: 2, ammo: 26 }, 
        'door.garage': { rocket: 2, c4: 1, satchel: 5, ammo: 60 },
        'door.armored': { rocket: 3, c4: 1, satchel: 8, ammo: 100 },
        'window.reinforced': { rocket: 2, c4: 1, satchel: 5, ammo: 50 }
    };

    const ammoCost = { rocket: 1400, c4: 2200, satchel: 480, ammo: 25 };

    const hitsNeeded = hitsTable[target][ammo];
    const totalAmmo = hitsNeeded * count;
    const totalSulfur = totalAmmo * ammoCost[ammo];

    document.getElementById('raidRes').style.display = 'block';
    document.getElementById('raidRes').innerHTML = `
        <div class="row"><span>Required</span> <strong style="font-size:18px; color:#ff4757">${totalAmmo} ${ammo.toUpperCase()}s</strong></div>
        <div class="row"><span>Total Sulfur Cost</span> <strong>${totalSulfur.toLocaleString()}</strong></div>
    `;
}

/* --- 3. ECO RAID (META FIX) --- */
function updateEcoRec() {
    const t = document.getElementById('ecoTarget').value;
    const rec = document.getElementById('ecoRec');
    let msg = "";
    if(t==='wall.wood') msg = "Best: <b>1x Sword</b> or <b>2x Spears</b>.";
    if(t==='wall.stone') msg = "Best: <b>7x Pickaxes</b> or <b>1.2x Jackhammers</b>.";
    if(t==='wall.metal') msg = "Best: <b>Jackhammers Only</b> (Picks are too slow).";
    if(t==='door.wood') msg = "Best: <b>19x Spears</b>.";
    if(t.includes('door') && !t.includes('wood')) msg = "Immune to tools. Use Explosives.";
    rec.innerHTML = `<i>üí°</i> <span>${msg}</span>`;
}

function calcEco() {
    const t = document.getElementById('ecoTarget').value;
    const tool = document.getElementById('ecoTool').value;
    const qty = +document.getElementById('ecoCount').value;

    // Hardcoded Meta Table (Quantities per 1 wall)
    // -1 means impossible/immune
    const meta = {
        'wall.wood': { spear: 2, jack: 0.1, pick: 1, sword: 1, hatchet: 1.5 },
        'wall.stone': { spear: 23, jack: 1.2, pick: 7, sword: 80, hatchet: 99 },
        'wall.metal': { spear: -1, jack: 13, pick: 50, sword: -1, hatchet: -1 },
        'door.wood': { spear: 19, jack: 0.5, pick: 2, sword: 2, hatchet: 4 },
        'door.sheet': { spear: -1, jack: -1, pick: -1, sword: -1, hatchet: -1 },
    };

    const countPerWall = meta[t][tool];

    if(countPerWall === -1 || countPerWall > 100) {
        document.getElementById('ecoRes').style.display = 'block';
        document.getElementById('ecoRes').innerHTML = `<strong style="color:#ff4757">NOT VIABLE / IMMUNE</strong>`;
        return;
    }

    const totalNeeded = (countPerWall * qty).toFixed(1);
    const label = ecoMode === 'fresh' ? 'New Tools' : 'Refills (Repair Bench)';

    document.getElementById('ecoRes').style.display = 'block';
    document.getElementById('ecoRes').innerHTML = `
        <div class="row"><span>Quantity</span> <strong style="color:#ff4757">${totalNeeded} ${label}</strong></div>
        <div style="font-size:12px; color:#666; margin-top:5px;">Based on Soft Side Durability Meta</div>
    `;
}

/* --- 4. COMPARE --- */
function calcCompare() {
    const getCost = (t, q) => {
        if(t==='rocket') return {s:1400*q, c:1950*q, m:100*q, p:2*q, tech:0, fuel:30*q};
        if(t==='c4') return {s:2200*q, c:3000*q, m:200*q, p:0, tech:2*q, fuel:60*q};
        if(t==='satchel') return {s:480*q, c:720*q, m:80*q, p:0, tech:0, fuel:0};
        return {s:0,c:0,m:0,p:0,tech:0,fuel:0};
    };

    const cA = getCost(document.getElementById('compA').value, +document.getElementById('amtA').value);
    const cB = getCost(document.getElementById('compB').value, +document.getElementById('amtB').value);
    
    let html = `<table class="comp-table"><thead><tr><th>Resource</th><th>Opt A</th><th>Opt B</th><th>Diff</th></tr></thead><tbody>`;
    const fields = [
        {key:'s', name:'Sulfur'}, {key:'c', name:'Charcoal'}, {key:'m', name:'Metal Frags'}, 
        {key:'fuel', name:'Low Grade'}, {key:'p', name:'Pipes'}, {key:'tech', name:'Tech Trash'}
    ];

    fields.forEach(f => {
        if(cA[f.key] > 0 || cB[f.key] > 0) {
            const diff = cA[f.key] - cB[f.key];
            const diffStr = diff > 0 ? `+${diff}` : diff;
            const diffClass = diff > 0 ? 'diff-bad' : 'diff-good';
            html += `<tr><td>${f.name}</td><td>${cA[f.key]}</td><td>${cB[f.key]}</td><td class="${diffClass}">${diffStr}</td></tr>`;
        }
    });
    
    html += `</tbody></table>`;
    document.getElementById('compRes').style.display = 'block';
    document.getElementById('compRes').innerHTML = html;
}

/* --- 5. SMELTING (NEW) --- */
function calcSmelt() {
    const s = +document.getElementById('smeltSulfur').value;
    const m = +document.getElementById('smeltMetal').value;
    const h = +document.getElementById('smeltHQM').value;
    
    // Ratios: 1000 Wood = 600 Ore Smelted (approx 1.67 Wood per Ore)
    const totalOre = s + m + h;
    const woodNeeded = Math.ceil(totalOre * 1.67);
    const charcoal = Math.floor(woodNeeded * 0.75);
    const timeSec = Math.ceil(totalOre * 2); // 2 seconds per ore
    const mins = Math.floor(timeSec / 60);

    document.getElementById('smeltRes').style.display='block';
    document.getElementById('smeltRes').innerHTML=`
        <div class="row"><span>Wood Needed</span> <strong style="color:#ffa502">${woodNeeded.toLocaleString()}</strong></div>
        <div class="row"><span>Charcoal Output</span> <strong>${charcoal.toLocaleString()}</strong></div>
        <div class="row"><span>Time (Single Furnace)</span> <strong>${mins} Mins</strong></div>
    `;
}

/* --- LOGIC: RECYCLER --- */
function calcRecycle() {
    const zone = document.getElementById('recZone').value;
    const mult = zone==='safe' ? 0.8 : 1.0;
    const target = +document.getElementById('recTarget').value;

    const inputs = {
        tech: {val:+document.getElementById('recTech').value, scrap:20, hqm:3},
        rifle: {val:+document.getElementById('recRifle').value, scrap:25, hqm:2},
        smg: {val:+document.getElementById('recSMG').value, scrap:15, hqm:2},
        gear: {val:+document.getElementById('recGear').value, scrap:10, hqm:13},
        spring: {val:+document.getElementById('recSpring').value, scrap:10, hqm:1},
        sheet: {val:+document.getElementById('recSheet').value, scrap:8, hqm:0},
    };

    let totalScrap = 0, totalHQM = 0;
    for (const key in inputs) {
        totalScrap += inputs[key].val * inputs[key].scrap;
        totalHQM += inputs[key].val * inputs[key].hqm;
    }
    
    totalScrap = Math.floor(totalScrap * mult);
    totalHQM = Math.floor(totalHQM * mult);

    let msg = "";
    if(target > 0) {
        if(totalScrap >= target) msg = `<div style="margin-top:10px; color:#2ed573">‚úÖ Goal Met! (+${totalScrap-target} surplus)</div>`;
        else msg = `<div style="margin-top:10px; color:#ff4757">‚ùå Short by ${target-totalScrap} Scrap.</div>`;
    }
    
    if(inputs.gear.val > 0) msg += `<div style="font-size:11px; color:#ffa502; margin-top:5px">‚ö†Ô∏è Warning: Gears needed for Garage Doors.</div>`;

    document.getElementById('recRes').style.display='block'; 
    document.getElementById('recRes').innerHTML=`
        <div class="row"><span>Total Scrap</span> <strong style="color:#ffa502">${totalScrap}</strong></div>
        <div class="row"><span>Total HQM</span> <strong>${totalHQM}</strong></div>
        ${msg}
    `;
}

function calcGene() {
    let res = ""; const w = {G:0.6,Y:0.6,H:1,S:1,W:1,X:0};
    for(let i=1; i<=6; i++){
        let sc={G:0,Y:0,H:0,S:0,W:0};
        for(let d=1; d<=2; d++){ let v=document.getElementById(`d${d}_${i}`).value.toUpperCase(); if(w[v]) sc[v]+=w[v]; }
        let win="?", mx=-1; for(let k in sc) if(sc[k]>mx){mx=sc[k]; win=k;}
        res+=win;
    }
    const box = document.getElementById('geneRes');
    box.style.display='block'; box.innerText=res;
    box.style.color = (res.includes('W')||res.includes('X')) ? '#ff4757' : '#2ed573';
}

function calcNodes() {
    document.getElementById('nodeRes').style.display='block';
    document.getElementById('nodeRes').innerHTML=`<div class="row"><span>Nodes</span> <strong>${Math.ceil(+document.getElementById('nodeNeed').value/300)}</strong></div>`;
}
function calcDiesel() {
    const a=+document.getElementById('dieselAmt').value;
    const l=document.getElementById('dieselLoc').value;
    const t=document.getElementById('dieselType').value;
    let r=l==='excavator'?(t==='sulfur'?2000:t==='hqm'?100:5000):(t==='sulfur'?1000:t==='hqm'?50:2500);
    document.getElementById('dieselRes').style.display='block'; document.getElementById('dieselRes').innerHTML=`<div class="row"><span>Yield</span> <strong style="color:#ffa502">${(a*r).toLocaleString()}</strong></div>`;
}
function calcHeli() {
    document.getElementById('heliRes').style.display='block';
    document.getElementById('heliRes').innerHTML=`<div class="row"><span>Airtime</span> <strong>${(+document.getElementById('lgfHeli').value/+document.getElementById('heliType').value).toFixed(1)} mins</strong></div>`;
}
function calcScrapGP() {
    const s = Math.ceil(+document.getElementById('gpWant').value/18)*5;
    document.getElementById('gpRes').style.display='block'; document.getElementById('gpRes').innerHTML=`<div class="row"><span>Scrap Cost</span> <strong style="color:#ffa502">${s}</strong></div>`;
}

// Init
updateEcoRec();
</script>
</body>
</html>
